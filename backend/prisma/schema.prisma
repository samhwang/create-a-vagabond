generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-1.0.x"]
}

generator pothos {
  provider = "prisma-pothos-types"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model RoguishFeat {
  id              String          @id
  name            String
  description     String
  risks           Json // string[]
  vagabondClasses VagabondClass[]
  vagabonds       Vagabond[]
}

model VagabondClass {
  id              String @id @default(cuid())
  name            String
  natures         Json // string[]
  drives          Json // string[]
  startingCharm   Int
  startingCunning Int
  startingFinesse Int
  startingLuck    Int
  startingMight   Int

  startingRoguishFeats RoguishFeat[]
  startingWeaponSkills Json // string[]

  vagabond Vagabond[]
}

model Nature {
  id          String     @id @default(cuid())
  name        String
  description String
  Vagabond    Vagabond[]
}

model Drive {
  id          String @id @default(cuid())
  name        String
  description String
}

model Reputation {
  id         String   @id @default(cuid())
  vagabondId String
  vagabond   Vagabond @relation(fields: [vagabondId], references: [id])
  faction    String   @default("Denizens")
  score      Int      @default(0)
  prestige   Int      @default(0)
  notoriety  Int      @default(0)

  @@index([vagabondId])
}

model Vagabond {
  id String @id @default(cuid())

  name String

  class           VagabondClass @relation(fields: [vagabondClassId], references: [id])
  vagabondClassId String

  nature       String
  drives       Json // string[]
  roguishFeats RoguishFeat[]

  charm           Int    @default(0)
  cunning         Int    @default(0)
  finesse         Int    @default(0)
  luck            Int    @default(0)
  might           Int    @default(0)
  availablePoints Int    @default(0)
  userId          String

  Reputation Reputation[]

  @@index([userId])
  @@index([vagabondClassId])
}
